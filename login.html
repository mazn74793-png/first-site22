<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</title>

  <style>
    body{margin:0;font-family:Arial;background:#071018;color:#e9eef7;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:24px}
    .card{width:min(520px,100%);background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);border-radius:18px;padding:18px;box-shadow:0 10px 30px rgba(0,0,0,.35)}
    h1{margin:0 0 14px;font-size:22px}
    label{display:block;margin:10px 0 6px;opacity:.9}
    input{width:100%;padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,.18);background:rgba(0,0,0,.25);color:#fff;outline:none}
    .row{display:flex;gap:10px;margin-top:14px}
    button{flex:1;padding:12px;border-radius:12px;border:0;cursor:pointer;font-weight:700}
    .primary{background:#3b82f6;color:white}
    .ghost{background:rgba(255,255,255,.08);color:#fff;border:1px solid rgba(255,255,255,.16)}
    .msg{margin-top:12px;padding:10px;border-radius:12px;background:rgba(0,0,0,.25);border:1px solid rgba(255,255,255,.12);min-height:20px;white-space:pre-wrap}
    a{color:#93c5fd}
    .hint{opacity:.8;margin-top:10px;font-size:13px;line-height:1.7}
  </style>

  <!-- 1) Supabase CDN -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <!-- 2) Client Ø¨ØªØ§Ø¹Ùƒ -->
  <script src="./supabase.js"></script>
  <!-- 3) Guard -->
  <script src="./guard.js"></script>
</head>

<body>
  <div class="card">
    <h1>ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h1>

    <label>Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„</label>
    <input id="email" type="email" placeholder="example@gmail.com" />

    <label>Ø§Ù„Ø¨Ø§Ø³ÙˆØ±Ø¯</label>
    <input id="password" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" />

    <div class="row">
      <button class="primary" id="btnLogin">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„</button>
      <button class="ghost" id="btnLogout">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
    </div>

    <div class="msg" id="msg"></div>

    <div class="hint">
      âœ… Ø¨Ø¹Ø¯ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù‡ØªØ±ÙˆØ­ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ù„Ù€ <a href="./products.html">products.html</a><br/>
      Ù„Ùˆ Ø¨ÙŠØ·Ù„Ø¹ Error: ØºØ§Ù„Ø¨Ù‹Ø§ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„/Ø§Ù„Ø¨Ø§Ø³ÙˆØ±Ø¯ ØºÙ„Ø· Ø£Ùˆ Email Confirm Ù…Ù‚ÙÙˆÙ„.
    </div>
  </div>

  <script>
    const sb = window.sb;
    const setMsg = (t) => document.getElementById("msg").textContent = t;

    document.getElementById("btnLogin").onclick = async () => {
      setMsg("Ø¬Ø§Ø±ÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„...");
      const email = document.getElementById("email").value.trim();
      const password = document.getElementById("password").value;

      const { error } = await sb.auth.signInWithPassword({ email, password });
      if (error) return setMsg("âŒ " + error.message);

      setMsg("âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„");
      location.href = "./products.html";
    };

    document.getElementById("btnLogout").onclick = async () => {
      await sb.auth.signOut();
      setMsg("âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬");
    };
  </script>
</body>
</html>
